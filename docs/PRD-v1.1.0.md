# WeekTrack — 产品需求文档 V1.1.0

**版本**：1.1.0  
**更新日期**：2026-02-25  
**状态**：开发中

---

## 一、版本目标

在 V1.0 稳定基础上，实现三项核心扩展：

1. **自由添加自定义习惯任务**（时长型 / 打卡型）
2. **记录页升级为多维度数据看板**
3. 细节打磨（Header 英文化等）

---

## 二、新功能详细需求

### 2.1 两种习惯类型

| 类型 | 说明 | 示例 |
|------|------|------|
| **时长型（duration）** | 每周累计目标时长，分次记录，自动汇总进度 | 看书 3h/周、听播客 2h/周 |
| **打卡型（checkin）** | 每日是/否打卡，无需时长，展示连续天数 | 早起、早睡、冥想 |

### 2.2 习惯配置字段

**时长型**：名称、图标（预设库）、主题色（预设色板）、周目标时长、是否有子类型

**打卡型**：名称、图标、主题色、打卡说明（可选）

### 2.3 首页卡片适配

- 时长型：沿用圆形进度环卡片，颜色跟随习惯配置
- 打卡型：展示「本周 7 天打卡格」+ 连续打卡天数 + 「今日打卡」按钮；已打卡则按钮置灰显示 ✓

### 2.4 Settings 页（新增）

- 展示所有习惯列表（内置 + 自定义）
- 内置习惯（健身、Vibe Coding）可编辑，不可删除
- 自定义习惯可编辑、可删除
- 「+ 新增习惯」按钮 → 底部抽屉选择类型 → 填写字段 → 保存

---

## 三、记录管理升级（Records 页）

### 3.1 顶部时间维度切换

```
[ 本周 ] [ 本月 ] [ 全部 ]

本周：ISO周，前后翻页（< 上周  本周  下周 >）
本月：自然月，前后翻页
全部：全量倒序，无分页
```

### 3.2 顶部统计摘要

当前时间范围内各习惯时长汇总卡片（时长型）/ 打卡次数（打卡型）

### 3.3 筛选 Tab

全部 / 各习惯类型（根据用户习惯动态生成）

### 3.4 记录条目信息增强

新增「星期几」字段，格式：`2月25日 周二 19:30`

### 3.5 Header 文字

「本周记录」→「Week Record」

---

## 四、数据结构

### habits_config（LocalStorage key: `habits_config`）

```json
[
  { "id": "fitness", "name": "健身", "icon": "fa-dumbbell", "color": "#34D399", "gradFrom": "#86EFAC", "gradTo": "#34D399", "type": "duration", "weekGoalMinutes": 300, "subTypes": [{"id":"basketball","name":"篮球","icon":"fa-basketball"},{"id":"gym","name":"健身房","icon":"fa-dumbbell"}], "builtIn": true },
  { "id": "vibe_coding", "name": "Vibe Coding", "icon": "fa-terminal", "color": "#F97316", "gradFrom": "#FED7AA", "gradTo": "FB923C", "type": "duration", "weekGoalMinutes": 600, "builtIn": true }
]
```

### 记录条目（扩展字段）

```json
{ "id": "abc", "habitId": "fitness", "type": "duration", "subType": "basketball", "minutes": 45, "datetime": "2026-02-25T19:30:00.000Z", "note": "" }
{ "id": "xyz", "habitId": "custom_wakeup", "type": "checkin", "minutes": 0, "datetime": "2026-02-25T06:58:00.000Z", "note": "" }
```

---

## 五、页面结构

| 页面 | V1.0 | V1.1.0 |
|------|------|--------|
| P1 首页 | 固定2张卡片 | 动态渲染 N 张卡片 |
| P2/P3 添加抽屉 | 固定两个 | 通用化，按习惯动态生成 |
| P4 记录列表 | 基础列表 | 时间维度 + 摘要 + 筛选 + 增强 |
| P5 设置 | 占位 | **本版本实现**：习惯管理 |

---

## 六、不在本版本范围

- 云同步、数据导出
- 图表趋势
- 推送通知
